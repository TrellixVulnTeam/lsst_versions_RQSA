* Replaced some debug prints with logging.
* Significantly improved the test coverage.
